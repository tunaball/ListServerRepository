<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> speaking incoming mail
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:x-unix%40listserver.themacintoshguy.com?Subject=speaking%20incoming%20mail&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000460.html">
   <LINK REL="Next"  HREF="000462.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">

<!--GoogleAdsAutomaticSizeSTART-->
<p align=CENTER>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Automatic Size -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1785703837751368"
     data-ad-slot="4468313549"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</p>
<!--GoogleAdsAutomaticSizeEND-->

   <H1>speaking incoming mail</H1>
    <B>Brian Medley</B> 
    <A HREF="mailto:x-unix%40listserver.themacintoshguy.com?Subject=speaking%20incoming%20mail&In-Reply-To="
       TITLE="speaking incoming mail">bpm-list-osx-unix at 4321.tv
       </A><BR>
    <I>Fri Mar 12 09:43:06 PST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000460.html">[X-Unix] Rsyncx
</A></li>
        <LI>Next message: <A HREF="000462.html">Quit Terminal on exit
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#461">[ date ]</a>
              <a href="thread.html#461">[ thread ]</a>
              <a href="subject.html#461">[ subject ]</a>
              <a href="author.html#461">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

For a while I've wanted to have some notification for when work
email arrives.  I recently got it to work via procmail, perl, and
applescript.  Below is what I used:

procmail.rc:

:<i>0:                                                                                                           
</I>* ^From.*<A HREF="../../../mailman/listinfo/x-unix.html">bobm at work</A>\.com
{                                                                                                             
    :0hc                                                                                                      
    | (/sw/bin/formail -c -x &quot;From:&quot;) | $HOME/bin/speakaddress.pl                                             
                                                                                                              
    :0:                                                                                                       
    inbox                                                                                                     
}                                                                                                             

speakaddress.pl:

#! /usr/bin/perl                                                                                              
                                                                                                              
use strict;                                                                                                   
use warnings;                                                                                                 

# these two modules need to be installed via cpan or wherever you
# get your modules
use Mac::AppleScript qw(RunAppleScript);                                                                      
use Mail::Address;                                                                                            
                                                                                                              
MAIN:                                                                                                         
{                                                                                                             
    my $address = &lt;&gt;;                                                                                         
                                                                                                              
    my ($addr) = Mail::Address-&gt;parse($address);                                                              
                                                                                                              
    my $speech = $addr-&gt;name() ? $addr-&gt;name() : $addr-&gt;user();                                               
                                                                                                              
    # Bob McDougal has a habit of not putting his full name on
    # his emails.
    if (&quot;bobm&quot; eq $speech) {                                                                              
        $speech = &quot;Bob McDougal&quot;;                                                                          
    }                                                                                                         
                                                                                                              
    my $script = qq(                                                                                          
        tell application &quot;Finder&quot; to say &quot;Mail from $speech&quot;                                                  
    );                                                                                                        
    &amp;RunAppleScript($script);                                                                                 
                                                                                                              
    exit 0;                                                                                                   
}                                                                                                             

-- 
~`^`'~=-._.-=~'`^`'~=-._.-=~'^'~=-., \|/  (___)  \|/ _,.-=~'`^`
                                      @~./'O o`\.~@
      &quot;Knowledge is Power&quot;           /__( \___/ )__\  *PPPFFBT!*
         -- Francis Bacon               `\__`U_/'
 _.-=~'``'~=-._.-=~'``'~=-._.-=~'`^`'~= &lt;____|'  ^^`'~=-.,__,.-=
~'^`'~=-._.-=~'`^`'~=-._.-=~'^'~=-.,__,.-==--^'~=-.,__,.-=~'`^`

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000460.html">[X-Unix] Rsyncx
</A></li>
	<LI>Next message: <A HREF="000462.html">Quit Terminal on exit
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#461">[ date ]</a>
              <a href="thread.html#461">[ thread ]</a>
              <a href="subject.html#461">[ subject ]</a>
              <a href="author.html#461">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/x-unix.html">More information about the X-Unix
mailing list</a><br>
<hr />
<!--GoogleAdsAutomaticSizeSTART-->
<p align=CENTER>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Automatic Size -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1785703837751368"
     data-ad-slot="4468313549"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</p>
<!--GoogleAdsAutomaticSizeEND-->

</body></html>
