<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [X4U] Need Applescript help for Mail
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:x4u%40listserver.themacintoshguy.com?Subject=%5BX4U%5D%20Need%20Applescript%20help%20for%20Mail&In-Reply-To=AF852FC1-4DC2-45F9-8C69-B5EA588495B4%40optonline.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005852.html">
   <LINK REL="Next"  HREF="005856.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">

<!--GoogleAdsAutomaticSizeSTART-->
<p align=CENTER>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Automatic Size -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1785703837751368"
     data-ad-slot="4468313549"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</p>
<!--GoogleAdsAutomaticSizeEND-->

   <H1>[X4U] Need Applescript help for Mail</H1>
    <B>Bill White</B> 
    <A HREF="mailto:x4u%40listserver.themacintoshguy.com?Subject=%5BX4U%5D%20Need%20Applescript%20help%20for%20Mail&In-Reply-To=AF852FC1-4DC2-45F9-8C69-B5EA588495B4%40optonline.net"
       TITLE="[X4U] Need Applescript help for Mail">billwhite at mac.com
       </A><BR>
    <I>Wed May 11 20:13:53 PDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="005852.html">[X4U] Need Applescript help for Mail
</A></li>
        <LI>Next message: <A HREF="005856.html">[X4U] spotlight and entourage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5857">[ date ]</a>
              <a href="thread.html#5857">[ thread ]</a>
              <a href="subject.html#5857">[ subject ]</a>
              <a href="author.html#5857">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 5/11/05 6:25 PM, John McGibney &lt;<A HREF="../../../mailman/listinfo/x4u.html">ensignjd at optonline.net</A>&gt; wrote:

&gt;<i> I'm trying to setup an applescript for Mail so that it will delete
</I>&gt;<i> messages based on these 2 conditions.
</I>&gt;<i> 
</I>&gt;<i> condition one
</I>&gt;<i> 1. mailbox folder is &quot;Temp Save&quot;
</I>&gt;<i> 2. subject contains the word digest
</I>&gt;<i> 3. and the date sent is one or more days old
</I>&gt;<i> 
</I>&gt;<i> condition two
</I>&gt;<i> 1. mailbox folder is &quot;Temp Save&quot;
</I>&gt;<i> 2. delete all messages older than 5 days
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Here's the script i wrote. but i can't get the line with subject to
</I>&gt;<i> work.
</I>&gt;<i> 
</I>&gt;<i> -=-=
</I>&gt;<i> 
</I>&gt;<i> tell application &quot;Mail&quot;
</I>&gt;<i>       set localMailboxes to &quot;Temp Save&quot;
</I>&gt;<i>       if message subject contains &quot;Digest&quot; then
</I>&gt;<i>           if date sent is not today then
</I>&gt;<i>               delete message
</I>&gt;<i>           end if
</I>&gt;<i>       else
</I>&gt;<i>           if date sent is greater than 5 then
</I>&gt;<i>               delete message
</I>&gt;<i>           end if
</I>&gt;<i>       end if
</I>&gt;<i> end tell
</I>&gt;<i> 
</I>&gt;<i> -=-=-=
</I>&gt;<i> 
</I>&gt;<i> here's the error message:
</I>&gt;<i> 
</I>&gt;<i> tell application &quot;Mail&quot;
</I>&gt;<i>       get subject
</I>&gt;<i>           &quot;Mail got an error: Can't make subject into type reference.&quot;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> any applescript gurus out there?
</I>
Mail is a bear to script (that's one of the many reasons I use Entourage, an
actual shining example of scriptability!). But dictionary and syntax aside,
there are several problems with your script above. I can go into more detail
if you want, but in here are three:

- set localMailboxes to &quot;Temp Save&quot; is just assigning the value &quot;Temp Save&quot;
to a variable named localMailboxes, not referencing a mailbox as such

- &quot;today&quot; isn't an AppleScript constant, and you haven't defined what today
is

- &quot;date sent&quot; [of a particular message] returns a date object, including
time and day of the week, so something like &quot;date sent greater than 5&quot; isn't
going to work

Try something like the following, with the caveat that I've stayed away from
scripting, or even dealing with(!), Mail. I'm just going by its dictionary
and some scripting logic:

---------- BEGIN SCRIPT ----------

set today to date string of (current date)

tell application &quot;Mail&quot;
    
    set theseMessages to every message of mailbox &quot;Temp Save&quot;
    
    repeat with thisMessage in theseMessages
        
        set msgDate to date sent of thisMessage
        set msgDateString to date string of msgDate
        
        if subject of thisMessage contains &quot;Digest&quot; and msgDateString is not
today then -- watch line wraps; should all be on one line
            
            delete thisMessage
            
        else
            
            if (current date) - (date sent of thisMessage) is greater than
(5 * days) then delete thisMessage -- watch line wraps; should be one line
            
        end if
        
    end repeat
    
end tell

----------- END SCRIPT -----------

This isn't tested, but I think it's more along the lines of what you're
after.

-- Bill


</PRE>




























































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005852.html">[X4U] Need Applescript help for Mail
</A></li>
	<LI>Next message: <A HREF="005856.html">[X4U] spotlight and entourage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5857">[ date ]</a>
              <a href="thread.html#5857">[ thread ]</a>
              <a href="subject.html#5857">[ subject ]</a>
              <a href="author.html#5857">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/x4u.html">More information about the X4U
mailing list</a><br>
<hr />
<!--GoogleAdsAutomaticSizeSTART-->
<p align=CENTER>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Automatic Size -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1785703837751368"
     data-ad-slot="4468313549"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</p>
<!--GoogleAdsAutomaticSizeEND-->

</body></html>
