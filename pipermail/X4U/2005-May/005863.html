<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [X4U] Need Applescript help for Mail
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:x4u%40listserver.themacintoshguy.com?Subject=%5BX4U%5D%20Need%20Applescript%20help%20for%20Mail&In-Reply-To=20050512131103.B93573D6326%40listserver.themacintoshguy.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005951.html">
   <LINK REL="Next"  HREF="005864.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">

<!--GoogleAdsAutomaticSizeSTART-->
<p align=CENTER>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Automatic Size -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1785703837751368"
     data-ad-slot="4468313549"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</p>
<!--GoogleAdsAutomaticSizeEND-->

   <H1>[X4U] Need Applescript help for Mail</H1>
    <B>John McGibney</B> 
    <A HREF="mailto:x4u%40listserver.themacintoshguy.com?Subject=%5BX4U%5D%20Need%20Applescript%20help%20for%20Mail&In-Reply-To=20050512131103.B93573D6326%40listserver.themacintoshguy.com"
       TITLE="[X4U] Need Applescript help for Mail">ensignjd at optonline.net
       </A><BR>
    <I>Thu May 12 08:01:30 PDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="005951.html">[X4U] Re: Tiger: what happened to my printer?
</A></li>
        <LI>Next message: <A HREF="005864.html">[X4U] Need Applescript help for Mail
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5863">[ date ]</a>
              <a href="thread.html#5863">[ thread ]</a>
              <a href="subject.html#5863">[ subject ]</a>
              <a href="author.html#5863">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I agree with you about Mail. I've been using Entourage for over a year. It
can automate more stuff than Mail. I'm probably going to stick with
Entourage. But Mail can display messages that Entourage chokes on. Entourage
also pins the CPU on some messages just to display them.

Since upgrading to Tiger I felt I'd give Mail another try. But you still
can't create a rule to delete messages based on subject and date sent. Nor
can it delete messages when they're deleted from Mail, only after a set # of
days.

Either way, thanks for the help. &quot;Applescript for Dummies&quot; is still too far
over my head.

John 
&gt;<i> 
</I>&gt;<i> Mail is a bear to script (that's one of the many reasons I use Entourage, an
</I>&gt;<i> actual shining example of scriptability!). But dictionary and syntax aside,
</I>&gt;<i> there are several problems with your script above. I can go into more detail
</I>&gt;<i> if you want, but in here are three:
</I>&gt;<i> 
</I>&gt;<i> - set localMailboxes to &quot;Temp Save&quot; is just assigning the value &quot;Temp Save&quot;
</I>&gt;<i> to a variable named localMailboxes, not referencing a mailbox as such
</I>&gt;<i> 
</I>&gt;<i> - &quot;today&quot; isn't an AppleScript constant, and you haven't defined what today
</I>&gt;<i> is
</I>&gt;<i> 
</I>&gt;<i> - &quot;date sent&quot; [of a particular message] returns a date object, including
</I>&gt;<i> time and day of the week, so something like &quot;date sent greater than 5&quot; isn't
</I>&gt;<i> going to work
</I>&gt;<i> 
</I>&gt;<i> Try something like the following, with the caveat that I've stayed away from
</I>&gt;<i> scripting, or even dealing with(!), Mail. I'm just going by its dictionary
</I>&gt;<i> and some scripting logic:
</I>&gt;<i> 
</I>&gt;<i> ---------- BEGIN SCRIPT ----------
</I>&gt;<i> 
</I>&gt;<i> set today to date string of (current date)
</I>&gt;<i> 
</I>&gt;<i> tell application &quot;Mail&quot;
</I>&gt;<i>   
</I>&gt;<i>   set theseMessages to every message of mailbox &quot;Temp Save&quot;
</I>&gt;<i>   
</I>&gt;<i>   repeat with thisMessage in theseMessages
</I>&gt;<i>       
</I>&gt;<i>       set msgDate to date sent of thisMessage
</I>&gt;<i>       set msgDateString to date string of msgDate
</I>&gt;<i>       
</I>&gt;<i>       if subject of thisMessage contains &quot;Digest&quot; and msgDateString is not
</I>&gt;<i> today then -- watch line wraps; should all be on one line
</I>&gt;<i>           
</I>&gt;<i>           delete thisMessage
</I>&gt;<i>           
</I>&gt;<i>       else
</I>&gt;<i>           
</I>&gt;<i>           if (current date) - (date sent of thisMessage) is greater than
</I>&gt;<i> (5 * days) then delete thisMessage -- watch line wraps; should be one line
</I>&gt;<i>           
</I>&gt;<i>       end if
</I>&gt;<i>       
</I>&gt;<i>   end repeat
</I>&gt;<i>   
</I>&gt;<i> end tell
</I>&gt;<i> 
</I>&gt;<i> ----------- END SCRIPT -----------
</I>&gt;<i> 
</I>&gt;<i> This isn't tested, but I think it's more along the lines of what you're
</I>&gt;<i> after.
</I>&gt;<i> 
</I>&gt;<i> -- Bill
</I>
-- 
 One OS to rule them all, One OS to find them.
 One OS to bring them all and in anti-competitive practices bind them.
 In the land of M$ where the Shadow lies.


</PRE>































































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005951.html">[X4U] Re: Tiger: what happened to my printer?
</A></li>
	<LI>Next message: <A HREF="005864.html">[X4U] Need Applescript help for Mail
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5863">[ date ]</a>
              <a href="thread.html#5863">[ thread ]</a>
              <a href="subject.html#5863">[ subject ]</a>
              <a href="author.html#5863">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../mailman/listinfo/x4u.html">More information about the X4U
mailing list</a><br>
<hr />
<!--GoogleAdsAutomaticSizeSTART-->
<p align=CENTER>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Automatic Size -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1785703837751368"
     data-ad-slot="4468313549"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</p>
<!--GoogleAdsAutomaticSizeEND-->

</body></html>
